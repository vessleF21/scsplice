rm(list=ls())
gc()
library(ComplexHeatmap)

data_frame <- data.frame(matrix(nrow = 10, ncol = 13))
data_frame[1, ] <- rep(1, 13)
data_frame[2, ] <- c(1,1,1,1,1,1,1,1,0,1,0,1,1)
data_frame[3, ] <- c(1,1,1,1,0,1,1,1,0,1,1,1,1)
data_frame[4, ] <- c(1,1,0,1,1,0,1,1,0,1,1,1,1)
data_frame[5, ] <- rep(1, 13)
data_frame[6, ] <- rep(1, 13)
data_frame[7, ] <- c(1,1,1,1,0,1,1,1,0,1,0,1,1)
data_frame[8, ] <- c(1,1,1,1,1,1,1,1,1,1,0,0,0)
data_frame[9, ] <- rep(1, 13)
data_frame[10, ] <- rep(1, 13)

colnames(data_frame) = c("BNav", "BMem", "CD4Naive","CD4EM",  "CD4Treg", "CD8Naive", "CD8GZMH", "CD8GZMK", "MAIT", "NKDim", "NKBright", "MonocM", "NoClaM")
rownames(data_frame) = c("HLA-A","HLA-C","HLA-F","HLA-DRB1","HLA-DMA","GAS5","ZFAS1","PCED1B-AS1","SNHG5","SNHG8")

annotation_row = data.frame(GeneClass = factor(rep(c("HLA", "lncRNA"), c(5, 5))))
ann_colors = list(GeneClass = c(HLA = "#7570B3", lncRNA = "#66A61E"))

pdf("HLA-A_heatmap.pdf", width = 10, height = 10)
pheatmap(data_frame, color = c("grey", "#D95F02"), cellwidth = 15, cellheight = 15, cluster_rows = FALSE, cluster_cols = FALSE, gaps_row = c(5), border_color = "black", annotation_row = annotation_row, annotation_colors = ann_colors)
dev.off()

rm(list=ls())
gc()
library(ComplexHeatmap)

data_frame <- data.frame(matrix(nrow = 29, ncol = 13))
data_frame[1, ] <- c(1,1,1,1,1,1,1,1,0,1,0,0,0)
data_frame[2, ] <- c(0,1,1,1,0,1,0,0,0,0,0,0,0)
data_frame[3, ] <- c(0,1,0,0,0,0,0,0,0,0,0,1,1)
data_frame[4, ] <- c(0,0,0,0,0,0,0,0,0,1,0,0,0)
data_frame[5, ] <- c(0,1,0,0,0,0,0,1,0,0,0,0,0)
data_frame[6, ] <- c(0,0,0,0,0,0,0,0,0,0,0,1,0)
data_frame[7, ] <- c(1,1,1,1,1,1,1,1,1,1,1,0,0)
data_frame[8, ] <- c(0,0,1,0,0,0,0,0,0,0,0,0,0)
data_frame[9, ] <- c(0,0,1,1,0,0,0,0,0,0,0,0,0)
data_frame[10, ] <- c(0,0,0,0,0,0,1,1,0,1,1,0,0)
data_frame[11, ] <- c(1,0,1,1,0,1,1,1,0,1,0,1,0)
data_frame[12, ] <- c(0,0,0,0,0,0,0,0,0,1,0,0,0)
data_frame[13, ] <- c(1,1,1,1,0,0,0,0,0,0,0,1,0)
data_frame[14, ] <- c(1,0,1,1,0,0,0,0,0,0,0,0,0)
data_frame[15, ] <- c(1,1,1,1,1,0,1,1,0,1,0,1,1)
data_frame[16, ] <- c(0,1,1,1,1,0,1,1,0,1,0,1,0)
data_frame[17, ] <- c(0,0,0,0,0,0,0,0,0,0,0,0,1)
data_frame[18, ] <- c(0,0,1,0,0,0,0,0,0,0,0,0,0)
data_frame[19, ] <- c(0,0,1,1,0,0,0,0,0,0,0,0,0)
data_frame[20, ] <- c(1,1,1,1,0,1,1,1,0,1,0,0,0)
data_frame[21, ] <- c(0,0,1,0,0,0,0,0,0,0,0,0,0)
data_frame[22, ] <- c(1,0,0,0,0,0,0,0,0,0,0,0,0)
data_frame[23, ] <- c(0,0,0,0,0,0,0,0,0,0,0,1,0)
data_frame[24, ] <- c(0,0,1,1,1,0,1,1,0,1,0,0,0)
data_frame[25, ] <- c(1,1,1,1,1,1,1,1,0,1,0,1,1)
data_frame[26, ] <- c(0,0,0,0,1,0,0,0,0,0,0,0,0)
data_frame[29, ] <- c(1,1,0,0,0,0,0,0,0,1,0,0,0)
data_frame[27, ] <- c(0,1,0,1,1,0,0,0,0,0,1,0,0)
data_frame[28, ] <- c(0,0,1,1,0,1,0,0,0,0,0,0,1)

colnames(data_frame) = c("BNav", "BMem", "CD4Naive","CD4EM", "CD4Treg", "CD8Naive", "CD8GZMH", "CD8GZMK", "MAIT", "NKDim", "NKBright", "MonocM", "NoClaM")
rownames(data_frame) = c("UQCRB","ATP5PO","PRELID1","TECR","TYMP","UBXN1","NCR3","IL32","IL7R","GNLY","ITGB2","CLEC2B","CD55","CD37","RAC1","CFLAR","LY96","RASGRP2","SIVA1","FDPS","SRSF2","SRSF10","HNRNPC","XRN2","U2AF1L4","ILF3","CDC42", "NUCKS1","BCL2A1")

annotation_row = data.frame(GeneClass = factor(rep(c("metabolism", "immunity", "signal pathway", "gene expression", "cell growth"), c(6, 8, 6, 6, 3))))
ann_colors = list(GeneClass = c(metabolism = "#7570B3", immunity = "#66A61E", "signal pathway" = "firebrick", "gene expression" = "#1B9E77", "cell growth" = "#D95F02"))

pdf("gene_heatmap.pdf", width = 10, height = 10)
pheatmap(data_frame, color = c("grey", "#D95F02"), cellwidth = 15, cellheight = 15, cluster_rows = FALSE, cluster_cols = FALSE, gaps_row = c(6,14,20,26,29), border_color = "black", annotation_row = annotation_row, annotation_colors = ann_colors)
dev.off()
